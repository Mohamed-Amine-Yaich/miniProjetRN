{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Pin from \"../components/Pin\";\nimport Masonry from \"react-native-masonry-layout\";\nimport { useNhostClient } from \"@nhost/react\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default function HomeScrren() {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      pins = _useState2[0],\n      setPins = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      Loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var refs = React.useRef();\n\n  var load = function load() {\n    refs.current.addItems(pins);\n  };\n\n  React.useEffect(function () {\n    if (refs != null && refs.current) {\n      if (pins) {\n        load();\n      }\n    }\n  }, [pins]);\n  React.useEffect(function () {\n    fetchPins();\n  }, []);\n  var nhost = useNhostClient();\n\n  var fetchPins = function _callee() {\n    var _await$nhost$graphql$, data, error;\n\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setLoading(true);\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(nhost.graphql.request(\"\\nquery{\\n  pins {\\n    title\\n    id\\n    user_id\\n    image\\n  }\\n}\\n\"));\n\n          case 3:\n            _await$nhost$graphql$ = _context.sent;\n            data = _await$nhost$graphql$.data;\n            error = _await$nhost$graphql$.error;\n\n            if (data) {\n              setPins(data.pins);\n            } else {\n              Alert.alert(\"error fetching pins\");\n            }\n\n            setLoading(false);\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var windowWidth = Math.ceil(Dimensions.get(\"window\").width / 350);\n  console.log(windowWidth);\n  return _jsx(Masonry, {\n    refreshing: Loading,\n    onRefresh: fetchPins,\n    ref: refs,\n    columns: windowWidth,\n    renderItem: function renderItem(item, index) {\n      return _jsx(Pin, {\n        pin: {\n          uri: item.image,\n          title: item.title,\n          id: item.id\n        }\n      }, index);\n    }\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    backgroundColor: \"#ecf0f1\",\n    padding: 5\n  }\n});","map":{"version":3,"names":["React","useState","Pin","Masonry","useNhostClient","HomeScrren","pins","setPins","Loading","setLoading","refs","useRef","load","current","addItems","useEffect","fetchPins","nhost","graphql","request","data","error","Alert","alert","windowWidth","Math","ceil","Dimensions","get","width","console","log","item","index","uri","image","title","id","styles","StyleSheet","create","container","flex","justifyContent","backgroundColor","padding"],"sources":["D:/react-native workSpace/vadimProjectNotjustDev/Printerest/PrinterestMyClone/screens/HomeScreen.tsx"],"sourcesContent":["import { AntDesign } from \"@expo/vector-icons\";\nimport React, { useState } from \"react\";\nimport {\n  StyleSheet,\n  Image,\n  View,\n  Text,\n  Dimensions,\n  Pressable,\n  TouchableOpacity,\n  ScrollView,\n  Alert,\n} from \"react-native\";\nimport Pin from \"../components/Pin\";\n\nimport Masonry from \"react-native-masonry-layout\";\n\n//import EditScreenInfo from '../components/EditScreenInfo';\n//import { Text} from '../components/Themed';\nimport { RootTabScreenProps } from \"../types\";\n//import pins from \"../assets/pins\";\nimport { Title } from \"react-native-paper\";\n\nimport { useNhostClient } from \"@nhost/react\";\n\nexport default function HomeScrren() {\n  const [pins, setPins] = useState([]);\n  const [Loading, setLoading] = useState(false);\n\n  const refs = React.useRef();\n\n  const load = () => {\n    refs.current.addItems(pins);\n  };\n\n  React.useEffect(() => {\n    if (refs?.current) {\n      if (pins) {\n        load();\n      }\n    }\n  }, [pins]);\n\n  React.useEffect(() => {\n    fetchPins();\n  }, []);\n\n  //use the useNHostClient Hook to get the client that we set up in App.tsx we get it with the provider(nhostprovider)\n  const nhost = useNhostClient();\n\n  const fetchPins = async () => {\n    //\n    setLoading(true);\n\n    //this do not response with data only if we set permissions\n    //you neet to define roles and permissons for those roles\n    //hasura support role-based access controle\n    //you can specify for each role the type of operation that he can do for each table\n    //the client that we have we did not specify his role cause his not authanticated so we can use a public role for making the request\n    const { data, error } = await nhost.graphql.request(`\nquery{\n  pins {\n    title\n    id\n    user_id\n    image\n  }\n}\n`);\n\n    if (data) {\n      setPins(data.pins);\n    } else {\n      Alert.alert(\"error fetching pins\");\n    }\n\n    setLoading(false);\n  };\n\n  const windowWidth = Math.ceil(Dimensions.get(\"window\").width / 350);\n  console.log(windowWidth);\n\n  return (\n    <Masonry\n      refreshing={Loading}\n      onRefresh={fetchPins}\n      ref={refs}\n      /*  style={{ flex: 1, borderWidth: 1, borderColor: 'red' }} */\n      columns={windowWidth} // optional - Default: 2\n      renderItem={(item, index) => (\n        <Pin\n          key={index}\n          pin={{ uri: item.image, title: item.title, id: item.id }}\n        />\n      )}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: \"center\",\n    /*paddingTop: Constants.statusBarHeight */\n    backgroundColor: \"#ecf0f1\",\n    padding: 5,\n  },\n});\n"],"mappings":";;AACA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;;;;AAYA,OAAOC,GAAP;AAEA,OAAOC,OAAP,MAAoB,6BAApB;AAQA,SAASC,cAAT,QAA+B,cAA/B;;AAEA,eAAe,SAASC,UAAT,GAAsB;EACnC,gBAAwBJ,QAAQ,CAAC,EAAD,CAAhC;EAAA;EAAA,IAAOK,IAAP;EAAA,IAAaC,OAAb;;EACA,iBAA8BN,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOO,OAAP;EAAA,IAAgBC,UAAhB;;EAEA,IAAMC,IAAI,GAAGV,KAAK,CAACW,MAAN,EAAb;;EAEA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;IACjBF,IAAI,CAACG,OAAL,CAAaC,QAAb,CAAsBR,IAAtB;EACD,CAFD;;EAIAN,KAAK,CAACe,SAAN,CAAgB,YAAM;IACpB,IAAIL,IAAJ,YAAIA,IAAI,CAAEG,OAAV,EAAmB;MACjB,IAAIP,IAAJ,EAAU;QACRM,IAAI;MACL;IACF;EACF,CAND,EAMG,CAACN,IAAD,CANH;EAQAN,KAAK,CAACe,SAAN,CAAgB,YAAM;IACpBC,SAAS;EACV,CAFD,EAEG,EAFH;EAKA,IAAMC,KAAK,GAAGb,cAAc,EAA5B;;EAEA,IAAMY,SAAS,GAAG;IAAA;;IAAA;MAAA;QAAA;UAAA;YAEhBP,UAAU,CAAC,IAAD,CAAV;YAFgB;YAAA,iCAScQ,KAAK,CAACC,OAAN,CAAcC,OAAd,2EATd;;UAAA;YAAA;YASRC,IATQ,yBASRA,IATQ;YASFC,KATE,yBASFA,KATE;;YAoBhB,IAAID,IAAJ,EAAU;cACRb,OAAO,CAACa,IAAI,CAACd,IAAN,CAAP;YACD,CAFD,MAEO;cACLgB,KAAK,CAACC,KAAN,CAAY,qBAAZ;YACD;;YAEDd,UAAU,CAAC,KAAD,CAAV;;UA1BgB;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAAlB;;EA6BA,IAAMe,WAAW,GAAGC,IAAI,CAACC,IAAL,CAAUC,UAAU,CAACC,GAAX,CAAe,QAAf,EAAyBC,KAAzB,GAAiC,GAA3C,CAApB;EACAC,OAAO,CAACC,GAAR,CAAYP,WAAZ;EAEA,OACE,KAAC,OAAD;IACE,UAAU,EAAEhB,OADd;IAEE,SAAS,EAAEQ,SAFb;IAGE,GAAG,EAAEN,IAHP;IAKE,OAAO,EAAEc,WALX;IAME,UAAU,EAAE,oBAACQ,IAAD,EAAOC,KAAP;MAAA,OACV,KAAC,GAAD;QAEE,GAAG,EAAE;UAAEC,GAAG,EAAEF,IAAI,CAACG,KAAZ;UAAmBC,KAAK,EAAEJ,IAAI,CAACI,KAA/B;UAAsCC,EAAE,EAAEL,IAAI,CAACK;QAA/C;MAFP,GACOJ,KADP,CADU;IAAA;EANd,EADF;AAeD;AAED,IAAMK,MAAM,GAAGC,UAAU,CAACC,MAAX,CAAkB;EAC/BC,SAAS,EAAE;IACTC,IAAI,EAAE,CADG;IAETC,cAAc,EAAE,QAFP;IAITC,eAAe,EAAE,SAJR;IAKTC,OAAO,EAAE;EALA;AADoB,CAAlB,CAAf"},"metadata":{},"sourceType":"module"}